## ServiceAccount

### 查看sa: 对应于ns的系统账号
```bash
kubectl get sa
kubectl get sa default -oyaml
```
> apiVersion: v1
kind: ServiceAccount
metadata:
  creationTimestamp: "2023-09-21T09:08:05Z"
  name: default
  namespace: default
  resourceVersion: "504"
  uid: 5c001670-5b7a-4206-bda3-9c87dbada22a
secrets:
\- name: **default-token-w8rr8**

### 查看secrets
```bash
kubectl get secrets
kubectl get secrets default-token-w8rr8 -o=yaml
kubectl get secrets default-token-w8rr8 -o=jsonpath='{.data.token}'
```
> 这个token 就是apiserver签发的Jwt Token
> 类似Lab: token-auth-file 静态token文件
> token: ZXlKaGJHY2lPaUpTVXpJMU5pSXNJbXRwWkNJNkluUm1Wa1pRYWs1MlQzcHhjakp0VldrdFJtZHNaa0ZJZWxWdWRtcEZibHB5WkZkdFdWaG1TbTh3UlVVaWZRLmV5SnBjM01pT2lKcmRXSmxjbTVsZEdWekwzTmxjblpwWTJWaFkyTnZkVzUwSWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOXVZVzFsYzNCaFkyVWlPaUprWldaaGRXeDBJaXdpYTNWaVpYSnVaWFJsY3k1cGJ5OXpaWEoyYVdObFlXTmpiM1Z1ZEM5elpXTnlaWFF1Ym1GdFpTSTZJbVJsWm1GMWJIUXRkRzlyWlc0dGR6aHljamdpTENKcmRXSmxjbTVsZEdWekxtbHZMM05sY25acFkyVmhZMk52ZFc1MEwzTmxjblpwWTJVdFlXTmpiM1Z1ZEM1dVlXMWxJam9pWkdWbVlYVnNkQ0lzSW10MVltVnlibVYwWlhNdWFXOHZjMlZ5ZG1salpXRmpZMjkxYm5RdmMyVnlkbWxqWlMxaFkyTnZkVzUwTG5WcFpDSTZJalZqTURBeE5qY3dMVFZpTjJFdE5ESXdOaTFpWkdFekxUbGpPRGRrWW1Ga1lUSXlZU0lzSW5OMVlpSTZJbk41YzNSbGJUcHpaWEoyYVdObFlXTmpiM1Z1ZERwa1pXWmhkV3gwT21SbFptRjFiSFFpZlEucjExZnhLTjBxYlRfZlpYek9RZ254ZHpLRnJDbkhDSXpnZW53OG94ZVd0TmRhRHNhRDZRVUpLR01mT2djVVE3ejhsQ1U0NlotUTZpV3VpNWs1WW9GUDlGS3kxbUdHX3d2c2hfRmQwSnNWTURpNzZQakRCb3gzVlFRUElESmNUMVFWNU9DRUtlZ3ItdDQzVWFUaHdadWNPT3oyWlpMaTlueUZzSWhXQWhyR0FubVNYLWJuczFiZEpYNWxoVE1PM2VpZVFSc3hlZ3NtdjE0Q044bEo3cWJBMklQb0swdVBHcVg4UjhYQWJsVkxXVzFkcDdLTFFLdmJmcmhNcnVjdHE1WTctdjdPYWswcFc4NmhqVUZaMy1IeFAzQjlBWjhEYTdCOTMtTncyYmZZM05JZTdET1ZkcG96MUM5bW5wS3JjdXIzS1pCT0h1ekxmdTVsUVE0WHhUVk5n

### 解码
```bash
cat <<EOF |base64 -d
ZXlKaGJHY2lPaUpTVXpJMU5pSXNJbXRwWkNJNkluUm1Wa1pRYWs1MlQzcHhjakp0VldrdFJtZHNaa0ZJZWxWdWRtcEZibHB5WkZkdFdWaG1TbTh3UlVVaWZRLmV5SnBjM01pT2lKcmRXSmxjbTVsZEdWekwzTmxjblpwWTJWaFkyTnZkVzUwSWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOXVZVzFsYzNCaFkyVWlPaUprWldaaGRXeDBJaXdpYTNWaVpYSnVaWFJsY3k1cGJ5OXpaWEoyYVdObFlXTmpiM1Z1ZEM5elpXTnlaWFF1Ym1GdFpTSTZJbVJsWm1GMWJIUXRkRzlyWlc0dGR6aHljamdpTENKcmRXSmxjbTVsZEdWekxtbHZMM05sY25acFkyVmhZMk52ZFc1MEwzTmxjblpwWTJVdFlXTmpiM1Z1ZEM1dVlXMWxJam9pWkdWbVlYVnNkQ0lzSW10MVltVnlibVYwWlhNdWFXOHZjMlZ5ZG1salpXRmpZMjkxYm5RdmMyVnlkbWxqWlMxaFkyTnZkVzUwTG5WcFpDSTZJalZqTURBeE5qY3dMVFZpTjJFdE5ESXdOaTFpWkdFekxUbGpPRGRrWW1Ga1lUSXlZU0lzSW5OMVlpSTZJbk41YzNSbGJUcHpaWEoyYVdObFlXTmpiM1Z1ZERwa1pXWmhkV3gwT21SbFptRjFiSFFpZlEucjExZnhLTjBxYlRfZlpYek9RZ254ZHpLRnJDbkhDSXpnZW53OG94ZVd0TmRhRHNhRDZRVUpLR01mT2djVVE3ejhsQ1U0NlotUTZpV3VpNWs1WW9GUDlGS3kxbUdHX3d2c2hfRmQwSnNWTURpNzZQakRCb3gzVlFRUElESmNUMVFWNU9DRUtlZ3ItdDQzVWFUaHdadWNPT3oyWlpMaTlueUZzSWhXQWhyR0FubVNYLWJuczFiZEpYNWxoVE1PM2VpZVFSc3hlZ3NtdjE0Q044bEo3cWJBMklQb0swdVBHcVg4UjhYQWJsVkxXVzFkcDdLTFFLdmJmcmhNcnVjdHE1WTctdjdPYWswcFc4NmhqVUZaMy1IeFAzQjlBWjhEYTdCOTMtTncyYmZZM05JZTdET1ZkcG96MUM5bW5wS3JjdXIzS1pCT0h1ekxmdTVsUVE0WHhUVk5n
EOF
``````
> eyJhbGciOiJSUzI1NiIsImtpZCI6InRmVkZQak52T3pxcjJtVWktRmdsZkFIelVudmpFblpyZFdtWVhmSm8wRUUifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6ImRlZmF1bHQtdG9rZW4tdzhycjgiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGVmYXVsdCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6IjVjMDAxNjcwLTViN2EtNDIwNi1iZGEzLTljODdkYmFkYTIyYSIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDpkZWZhdWx0OmRlZmF1bHQifQ.r11fxKN0qbT_fZXzOQgnxdzKFrCnHCIzgenw8oxeWtNdaDsaD6QUJKGMfOgcUQ7z8lCU46Z-Q6iWui5k5YoFP9FKy1mGG_wvsh_Fd0JsVMDi76PjDBox3VQQPIDJcT1QV5OCEKegr-t43UaThwZucOOz2ZZLi9nyFsIhWAhrGAnmSX-bns1bdJX5lhTMO3eieQRsxegsmv14CN8lJ7qbA2IPoK0uPGqX8R8XAblVLWW1dp7KLQKvbfrhMructq5Y7-v7Oak0pW86hjUFZ3-HxP3B9AZ8Da7B93-Nw2bfY3NIe7DOVdpoz1C9mnpKrcur3KZBOHuzLfu5lQQ4XxTVNg

### 访问
```bash
curl https://172.18.27.134:6443/api/v1/namespaces/default -H "Authorization: Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6InRmVkZQak52T3pxcjJtVWktRmdsZkFIelVudmpFblpyZFdtWVhmSm8wRUUifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6ImRlZmF1bHQtdG9rZW4tdzhycjgiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGVmYXVsdCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6IjVjMDAxNjcwLTViN2EtNDIwNi1iZGEzLTljODdkYmFkYTIyYSIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDpkZWZhdWx0OmRlZmF1bHQifQ.r11fxKN0qbT_fZXzOQgnxdzKFrCnHCIzgenw8oxeWtNdaDsaD6QUJKGMfOgcUQ7z8lCU46Z-Q6iWui5k5YoFP9FKy1mGG_wvsh_Fd0JsVMDi76PjDBox3VQQPIDJcT1QV5OCEKegr-t43UaThwZucOOz2ZZLi9nyFsIhWAhrGAnmSX-bns1bdJX5lhTMO3eieQRsxegsmv14CN8lJ7qbA2IPoK0uPGqX8R8XAblVLWW1dp7KLQKvbfrhMructq5Y7-v7Oak0pW86hjUFZ3-HxP3B9AZ8Da7B93-Nw2bfY3NIe7DOVdpoz1C9mnpKrcur3KZBOHuzLfu5lQQ4XxTVNg" -k
``````
>   "message": "namespaces \"default\" is **forbidden**: User \"system:serviceaccount:default:default\" cannot get resource \"namespaces\" in API group \"\" in the namespace \"default\"",

